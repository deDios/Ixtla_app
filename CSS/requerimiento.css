/* ================= Vars / Base ================= */
.exp-view{
  --exp-border:#e5e7eb; --exp-muted:#6b7280; --exp-ink:#111827;
  --exp-brand:#6aa995;  --exp-accent:#4f6b95;
}
.exp-view{ position:relative; z-index:0; }

/* ================= Head ================= */
.exp-view .exp-head{ display:grid; gap:10px; align-items:end; }
@media (min-width:840px){ .exp-view .exp-head{ grid-template-columns:1fr auto; } }

.exp-view .exp-title{ display:flex; align-items:center; gap:10px; padding-bottom:.8rem; }
.exp-view .exp-title .exp-icon{ width:38px; height:38px; object-fit:contain; }
.exp-view .exp-title h1{ margin:0; font-weight:800; font-size:1.5rem; color:var(--exp-ink); }

.exp-view .exp-meta{ display:grid; grid-template-columns:repeat(3,minmax(180px,1fr)); gap:10px; }
.exp-view .exp-meta dt{ font-size:.82rem; color:var(--exp-muted); }
.exp-view .exp-meta dd{ margin:2px 0 0; font-weight:600; color:var(--exp-ink); }

/* ================= Tabs ================= */
.exp-view .exp-tabs{ display:flex; gap:14px; border-bottom:1px solid var(--exp-border); margin-top:10px; }
.exp-view .exp-tab{ all:unset; cursor:pointer; padding:10px 12px; border-radius:8px 8px 0 0; font-weight:700; color:#1f2937; }
.exp-view .exp-tab.is-active{ background:#fff; box-shadow:0 -1px 0 #dfe3e7, 1px 0 0 #dfe3e7, -1px 0 0 #dfe3e7; }

.exp-panes{ position:relative; overflow-anchor:none; transition:height .2s ease; }
.exp-view .exp-pane{ min-height:240px; padding-top:10px; }
.exp-view .exp-pane:not(.is-active){ display:none; }

/* ================= Grid de campos ================= */
.exp-view .exp-grid{ display:grid; grid-template-columns:1fr 1fr; gap:10px 24px; margin-bottom:10px; }
@media (max-width:700px){ .exp-view .exp-grid{ grid-template-columns:1fr; } }
.exp-view .exp-field label{ display:block; font-size:.9rem; color:#374151; margin-bottom:6px; }
.exp-view .exp-val{ border-bottom:1px solid #e2e5ea; padding:6px 0 8px; color:#111827; }
.exp-view .exp-val a{ color:var(--exp-accent); text-decoration:none; }

/* ================= Acordeón base ================= */
.exp-view .exp-accordion{ margin-top:16px; border-radius:12px; }
.exp-view .exp-acc-head{
  width:100%; display:flex; justify-content:space-between; align-items:center;
  background:#f7f8fa; border:1px solid var(--exp-border); border-radius:12px 12px 0 0;
  padding:12px 14px; font-weight:600; color:var(--exp-ink);
}
.exp-view .exp-acc-head .chev{
  width:18px; height:18px; border-right:2px solid var(--exp-muted); border-bottom:2px solid var(--exp-muted);
  transform:rotate(45deg); transition:transform .2s ease;
}
.exp-view .exp-acc-head[aria-expanded="true"] .chev{ transform:rotate(-135deg); }

/* El cuerpo no pelea con la animación JS */
.exp-view .exp-acc-body{
  border:1px solid var(--exp-border); border-top:0; border-radius:0 0 12px 12px;
  padding:0; overflow:hidden; background:#fff;
  display:block;               /* evita rebotes */
  transition:none !important;  /* el JS setea la transición en inline */
}

/* ================= Tabla simple (Evidencias) ================= */
.exp-view .exp-table{ display:block; }
.exp-view .exp-thead,
.exp-view .exp-row{ display:grid; grid-template-columns:1.2fr .7fr 1fr; gap:0; align-items:center; }
.exp-view .exp-thead{ background:#f3f4f6; font-weight:600; color:#1f2937; padding:12px 14px; border-bottom:1px solid var(--exp-border); }
.exp-view .exp-thead .sort{ color:#9aa1a9; font-weight:800; margin-left:6px; }

.exp-view .exp-row{ padding:14px; min-height:48px; border-top:1px solid #f0f2f5; color:#111827; text-decoration:none; background:#fff; }
.exp-view .exp-row:hover{ background:#fafafa; }
.exp-view .exp-row .file{ display:inline-flex; align-items:center; gap:10px; min-width:0; }
.exp-view .exp-row .ico{ width:22px; height:22px; object-fit:contain; flex:0 0 auto; }
.exp-view .who, .exp-view .date{ color:#374151; }

@media (max-width:760px){
  .exp-view .exp-thead{ display:none; }
  .exp-view .exp-row{ grid-template-columns:1fr; gap:6px; align-items:flex-start; }
  .exp-view .who::before{ content:"Quien lo cargó: "; color:var(--exp-muted); font-weight:600; margin-right:4px; }
  .exp-view .date::before{ content:"Última modificación: "; color:var(--exp-muted); font-weight:600; margin-right:4px; }
}

/* ================= PLANEACIÓN (limpio/unificado) ================= */

/* Header de fase: una fila [left | actions | right] */
.exp-view .exp-accordion--fase{ margin-top:12px; }
.exp-view .exp-accordion--fase > .exp-acc-head{
  display:flex; align-items:center; gap:12px;
  padding:12px 14px; background:#f3f4f6;
  border:1px solid var(--exp-border); border-radius:8px;
  box-shadow:0 1px 2px rgba(17,24,39,.04);
}
/* Izquierda (título + meta) + botón “Nueva tarea” al lado */
.exp-view .exp-accordion--fase .fase-left{ display:flex; align-items:center; gap:12px; min-width:0; }
.exp-view .exp-accordion--fase .fase-head{ display:flex; flex-direction:column; line-height:1.1; min-width:0; }
.exp-view .exp-accordion--fase .fase-title{ font-weight:700; color:#111827; }
.exp-view .exp-accordion--fase .fase-meta{ color:#6b7280; font-size:.8rem; margin-top:2px; }
.exp-view .exp-accordion--fase .fase-actions{ flex:0 0 auto; }
.exp-view .exp-accordion--fase .fase-add{
  display:inline-block; text-decoration:none; cursor:pointer;
  padding:.38rem .7rem; border:1px solid #e5e7eb; border-radius:8px;
  background:#fff; font-weight:700; font-size:.85rem; line-height:1; white-space:nowrap;
}
.exp-view .exp-accordion--fase .fase-add:hover{ background:#f9fafb; }

/* Derecha (estatus, progreso, fecha) */
.exp-view .exp-accordion--fase .fase-right{
  margin-left:auto; display:flex; align-items:center; gap:12px; flex-wrap:wrap;
  color:#6b7280; font-size:.85rem;
}
.exp-view .exp-accordion--fase .fase-date{ color:#111827; font-weight:600; }

/* Chevron al final y SOLO clickable */
.exp-view .exp-accordion--fase > .exp-acc-head .chev{
  width:12px; height:12px; border-right:2px solid #6b7280; border-bottom:2px solid #6b7280;
  transform:rotate(-135deg); transition:transform .2s ease; cursor:pointer;
}
.exp-view .exp-accordion--fase > .exp-acc-head[aria-expanded="false"] .chev{ transform:rotate(45deg); }
/* Header no clickable */
#planeacion-list .exp-accordion--fase > .exp-acc-head{ cursor:default; }
#planeacion-list .exp-accordion--fase > .exp-acc-head .chev:focus-visible{ outline:2px solid #3b82f6; outline-offset:2px; }

/* Cuerpo de planeación */
.exp-view .exp-accordion--fase > .exp-acc-body{
  border:1px solid var(--exp-border); border-top:0; border-radius:0 0 8px 8px;
  overflow:hidden; background:#fff; box-shadow:0 1px 2px rgba(17,24,39,.04);
  display:block; transition:none !important;
}

/* Tabla de planeación (5 columnas) */
.exp-view .exp-table.exp-table--planeacion .exp-thead,
.exp-view .exp-table.exp-table--planeacion .exp-row{
  display:grid !important;
  grid-template-columns:1.6fr 1fr .9fr 1fr .9fr !important; /* Actividad | Responsable | Estatus | % | Fecha */
  align-items:center; gap:0;
}
.exp-view .exp-table.exp-table--planeacion .exp-thead{
  background:#f3f4f6; border-bottom:1px solid var(--exp-border);
  padding:10px 14px; color:#1f2937; font-weight:600;
}
.exp-view .exp-table.exp-table--planeacion .exp-thead > div{ display:flex; align-items:center; height:100%; }
.exp-view .exp-table.exp-table--planeacion .exp-thead > div:nth-child(1),
.exp-view .exp-table.exp-table--planeacion .exp-thead > div:nth-child(2){ justify-content:flex-start; }
.exp-view .exp-table.exp-table--planeacion .exp-thead > div:nth-child(3),
.exp-view .exp-table.exp-table--planeacion .exp-thead > div:nth-child(4),
.exp-view .exp-table.exp-table--planeacion .exp-thead > div:nth-child(5){ justify-content:center; }

.exp-view .exp-table.exp-table--planeacion .exp-row{
  padding:14px; min-height:60px; border-top:1px solid #edf0f3; background:#fff;
}
.exp-view .exp-table.exp-table--planeacion .exp-row > div{ display:flex; align-items:center; min-height:32px; }
.exp-view .exp-table.exp-table--planeacion .exp-row > div:nth-child(1),
.exp-view .exp-table.exp-table--planeacion .exp-row > div:nth-child(2){ justify-content:flex-start; }
.exp-view .exp-table.exp-table--planeacion .exp-row > div:nth-child(3),
.exp-view .exp-table.exp-table--planeacion .exp-row > div:nth-child(4),
.exp-view .exp-table.exp-table--planeacion .exp-row > div:nth-child(5){ justify-content:center; }

/* Barra de porcentaje */
.exp-view .exp-table.exp-table--planeacion .porcentaje .exp-progress{
  width:120px; min-width:120px; height:14px; padding:0 4px;
  background:#eef2f5; border:1px solid #e5e7eb; border-radius:999px;
  display:flex; align-items:center; justify-content:flex-start;
}
.exp-view .exp-table.exp-table--planeacion .porcentaje .exp-progress .bar{
  height:8px; border-radius:999px; background:var(--exp-brand); display:block;
}

/* Responsive planeación */
@media (max-width:760px){
  .exp-view .exp-accordion--fase > .exp-acc-head{ flex-wrap:wrap; }
  .exp-view .exp-accordion--fase .fase-right{ width:100%; justify-content:flex-start; }

  .exp-view .exp-table.exp-table--planeacion .exp-thead{ display:none !important; }
  .exp-view .exp-table.exp-table--planeacion .exp-row{
    grid-template-columns:1fr !important; gap:6px; align-items:flex-start;
  }
  .exp-view .exp-table.exp-table--planeacion .exp-row > div{ justify-content:flex-start; }
  .exp-view .exp-table.exp-table--planeacion .responsable::before{ content:"Responsable: "; color:#6b7280; font-weight:600; margin-right:4px; }
  .exp-view .exp-table.exp-table--planeacion .estatus::before{ content:"Estatus: "; color:#6b7280; font-weight:600; margin-right:4px; }
  .exp-view .exp-table.exp-table--planeacion .porcentaje::before{ content:"Porcentaje: "; color:#6b7280; font-weight:600; margin-right:4px; }
  .exp-view .exp-table.exp-table--planeacion .fecha::before{ content:"Fecha de inicio: "; color:#6b7280; font-weight:600; margin-right:4px; }
}

/* ================= Stepper ================= */
.step-menu{ list-style:none; margin:0 auto; padding:0; }
.step-menu::after{ content:""; display:block; clear:both; }
.step-menu li{
  float:left; box-sizing:border-box; background:#ddd; height:50px; text-align:center;
  padding:15px 15px 15px 50px; position:relative; margin-left:10px;
}
.step-menu li:before{
  content:""; position:absolute; border:25px solid transparent; border-left-color:#fff; top:0; right:-60px;
}
.step-menu li:after{
  content:""; position:absolute; border:25px solid transparent; border-left-color:#ddd; top:0; right:-50px;
}
.step-menu li:nth-child(1){ z-index:600; margin-left:0; padding-left:30px; }
.step-menu li:nth-child(2){ z-index:500; }
.step-menu li:nth-child(3){ z-index:400; }
.step-menu li:nth-child(4){ z-index:300; }
.step-menu li:nth-child(5){ z-index:200; }
.step-menu li:nth-child(6){ z-index:100; padding-right:30px; }
.step-menu li:nth-child(6):after,
.step-menu li:nth-child(6):before{ border:none; }

.step-menu li.current{ background:rgba(51,122,183,.75); color:#fff; }
.step-menu li.current:after{ border-left-color:rgba(51,122,183,.75); }
.step-menu li.complete{ background:rgba(51,122,183,.4); color:#fff; }
.step-menu li.complete:after{ border-left-color:rgba(51,122,183,.4); }

/* ================= Acciones junto al título ================= */
.exp-actions{ display:flex; gap:8px; flex-wrap:wrap; margin-left:8px; }
.exp-actions .btn-xs{
  all:unset; display:inline-flex; align-items:center; gap:8px; padding:8px 12px;
  border-radius:10px; font-weight:700; cursor:pointer; background:#eef2f6; border:1px solid #dfe3ea; color:#0f172a;
}
.exp-actions .btn-xs.primary{ background:#e6f0ea; border-color:#cfe4d6; color:#0e4f34; }
.exp-actions .btn-xs.warn{    background:#fff6e5; border-color:#ffe7b8; color:#7a5a1f; }
.exp-actions .btn-xs.danger{  background:#ffeaea; border-color:#ffc9c9; color:#a82b2b; }
.exp-actions .btn-xs:active{ transform:translateY(1px); }

/* ================= Badges / Utilidades ================= */
.exp-view .exp-field--full{ grid-column:1 / -1; }
.exp-view .exp-preline{ white-space:pre-line; }

/*
.badge,.exp-badge{
  display:inline-block; padding:.18rem .5rem; border-radius:999px; font-size:.78rem; line-height:1; font-weight:700;
  background:#eef2f7; color:#374151; border:1px solid #e5e7eb; vertical-align:middle;
}
.badge--info,    .exp-badge.is-info    { background:#e8f1ff; border-color:#cfe3ff; color:#285ea8; }
.badge--success, .exp-badge.is-success { background:#e8f7ef; border-color:#cfeede; color:#1f7a4d; }
.badge--warning, .exp-badge.is-warning { background:#fff6e5; border-color:#ffe7b8; color:#7a5a1f; }
.badge--danger,  .exp-badge.is-danger  { background:#ffeaea; border-color:#ffc9c9; color:#a82b2b; }
.badge--muted,   .exp-badge.is-muted   { background:#f3f4f6; border-color:#e5e7eb; color:#6b7280; }
*/

.exp-view .exp-progress{ position:relative; display:inline-flex; align-items:center; gap:8px; height:20px; min-width:88px; padding:0 6px; border-radius:999px; background:#eef2f5; border:1px solid #e5e7eb; }
.exp-view .exp-progress .bar{ height:8px; min-width:8px; border-radius:999px; background:#6aa995; display:block; }
.exp-view .exp-progress .pct{ font-size:.75rem; color:#111827; font-weight:700; }
.exp-view .exp-progress.xs{ height:14px; padding:0 4px; min-width:70px; }

/* ================= Modal Pausar/Cancelar ================= */
.modal-overlay{ position:fixed; inset:0; background:rgba(17,24,39,.56); display:none; opacity:0; visibility:hidden; z-index:10000; transition:opacity .2s ease; }
.modal-overlay.open{ display:block; opacity:1; visibility:visible; }
body.me-modal-open{ overflow:hidden; }

#modal-estado .modal-content{
  max-width:740px; width:min(92vw,740px); margin:auto; padding:28px 32px; border-radius:14px; background:#fff;
  box-shadow:0 20px 50px rgba(3,10,18,.25); opacity:1; visibility:visible; animation:me-fade-in .18s ease, me-pop .18s ease;
}
#modal-estado #estado-title{ margin:0 0 16px; font-size:clamp(22px,2.4vw,32px); line-height:1.15; text-align:center; }
#modal-estado .modal-content .form-row{ max-width:640px; margin:0 auto 16px; }
#modal-estado .modal-content label{ display:block; font-weight:600; margin:10px 0 8px; color:#111827; }
#modal-estado #estado-motivo{
  display:block; width:100%; height:180px; min-height:180px; max-height:180px;
  padding:12px 14px; border-radius:10px; border:1px solid #d1d5db; background:#fff;
  line-height:1.5; resize:none; overflow:auto; box-sizing:border-box;
  font:400 15px/1.5 system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial;
}
#modal-estado #estado-motivo::placeholder{ color:#9aa3af; }
#modal-estado #estado-motivo:focus{ outline:none; border-color:#3b82f6; box-shadow:0 0 0 3px rgba(59,130,246,.25); }
#modal-estado .btn-submit{
  width:100%; height:44px; font-weight:700; border-radius:10px;
  background:#3b82f6; border:1px solid #3573d6; color:#fff; transition:transform .06s ease, filter .12s ease;
}
#modal-estado .btn-submit:hover{ filter:brightness(1.05); }
#modal-estado .btn-submit:active{ transform:translateY(1px); }
#modal-estado .modal-note{ max-width:640px; margin:14px auto 0; color:#374151; text-align:left; }
@keyframes me-fade-in{ from{opacity:0} to{opacity:1} } @keyframes me-pop{ from{transform:scale(.985)} to{transform:scale(1)} }
@media (max-width:480px){ #modal-estado #estado-motivo{ height:200px; min-height:200px; max-height:200px; } }

/* ================= Planeación toolbar + botones ================= */
.planeacion-toolbar{
  display:flex; align-items:center; gap:10px;
  margin:10px 0 6px; padding:8px 10px; background:#f7f8fa;
  border:1px solid var(--exp-border); border-radius:10px;
}
.planeacion-toolbar .ptb-label{ font-weight:700; color:var(--exp-ink); }

/* pill reutilizable: coincide con .fase-add */
.planeacion-toolbar #btn-add-proceso,
.exp-view .exp-accordion--fase .fase-add{
  border:1px solid #e5e7eb; background:#fff; color:#0f172a;
  font-weight:700; font-size:.85rem; line-height:1;
  padding:.38rem .7rem; border-radius:8px; white-space:nowrap;
  display:inline-block; text-decoration:none; cursor:pointer;
  transition:background .2s ease, filter .12s ease, transform .06s ease;
}
.planeacion-toolbar #btn-add-proceso:hover,
.exp-view .exp-accordion--fase .fase-add:hover{ background:#f9fafb; }
.planeacion-toolbar #btn-add-proceso:active,
.exp-view .exp-accordion--fase .fase-add:active{ transform:translateY(1px); }
.planeacion-toolbar #btn-add-proceso:focus-visible{
  outline:2px solid #3b82f6; outline-offset:2px;
}

.exp-accordion .exp-acc-body[aria-hidden="true"]{ display:none !important; }


/* ===== Planeación: toolbar superior ===== */
.planeacion-toolbar{
  display:flex; align-items:center; gap:10px;
  margin:10px 0 6px;
  padding:8px 10px;
  background:#f7f8fa;
  border:1px solid var(--exp-border);
  border-radius:10px;
}

.planeacion-toolbar .planeacion-title{
  font-weight:800; color:var(--exp-ink); margin:0;
}

/* Botones “pill” unificados */
.planeacion-toolbar .fase-add{
  border:1px solid #e5e7eb;
  background:#fff;
  color:#0f172a;
  font-weight:700;
  font-size:.85rem;
  line-height:1;
  padding:.38rem .7rem;
  border-radius:8px;
  white-space:nowrap;
  display:inline-block;
  text-decoration:none;
  cursor:pointer;
  transition:background .2s ease, filter .12s ease, transform .06s ease;
}
.planeacion-toolbar .fase-add:hover{ background:#f9fafb; }
.planeacion-toolbar .fase-add:active{ transform:translateY(1px); }
.planeacion-toolbar .fase-add:focus-visible{
  outline:2px solid #3b82f6;
  outline-offset:2px;
}


/* ===== Evidencias: chevron compacto y clickeable (no afecta .exp-accordion--fase) ===== */
.exp-view .exp-accordion:not(.exp-accordion--fase) > .exp-acc-head{
  cursor: pointer;                  /* que “se sienta” clickeable */
}

.exp-view .exp-accordion:not(.exp-accordion--fase) > .exp-acc-head .chev{
  margin-left: 10px;                /* separa del texto */
  width: 12px;                      /* mismo tamaño que planeación */
  height: 12px;
  flex: 0 0 12px;                   /* evita que se deforme */
  border-right: 2px solid #6b7280;  /* gris neutro */
  border-bottom: 2px solid #6b7280;
  transform: rotate(-135deg);       /* estado abierto */
  transition: transform .2s ease, opacity .2s ease;
  opacity: .9;
  cursor: pointer;                  /* cursor de “mano” sobre el ícono */
}

.exp-view .exp-accordion:not(.exp-accordion--fase) > .exp-acc-head[aria-expanded="false"] .chev{
  transform: rotate(45deg);         /* estado cerrado */
  opacity: .9;
}

/* Accesibilidad visual al navegar con teclado */
.exp-view .exp-accordion:not(.exp-accordion--fase) > .exp-acc-head .chev:focus-visible{
  outline: 2px solid #3b82f6;
  outline-offset: 2px;
  border-radius: 2px;
}


/* Overlay centrado con flex */
.modal-overlay{
  position:fixed; inset:0; background:rgba(17,24,39,.56);
  display:none; opacity:0; visibility:hidden;
  z-index:10000; transition:opacity .2s ease, visibility .2s ease;
}
.modal-overlay.open{
  display:flex;                 /* centrado */
  align-items:center;
  justify-content:center;
  opacity:1; visibility:visible;
}

/* Contenido: permitir scroll interno si es alto */
#modal-estado .modal-content{
  max-width:740px; width:min(92vw,740px);
  max-height:min(92vh, 760px);
  overflow:auto;                /* scroll si se pasa */
  margin:0;                     /* ya no dependemos del auto centering antiguo */
}

/* Botón de cierre enfocables y visibles */
#modal-estado .modal-close{
  position:absolute; top:10px; right:14px;
  background:transparent; border:0; font-size:22px; line-height:1;
  cursor:pointer;
}
#modal-estado .modal-close:focus-visible{
  outline:2px solid #3b82f6; outline-offset:2px;
}


/* =========================
   Modal: Nueva tarea
   ID esperado: #modal-tarea
   ========================= */

/* Tamaño y layout del contenedor del modal */
#modal-tarea .modal-content{
  max-width: 720px;              /* un poco más ancho que el de “estado” */
  width: calc(100% - 2rem);
  padding: 1.25rem 1.25rem 1.5rem;
  border-radius: 14px;
}

/* Título del modal */
#modal-tarea .modal-content h2{
  margin: 0 0 .75rem 0;
  font-size: 1.25rem;
  font-weight: 700;
}

/* Texto auxiliar bajo campos */
#modal-tarea .modal-note,
#modal-tarea .help-text{
  margin-top: .75rem;
  font-size: .9rem;
  color: #6b7280; /* gris medio */
}

/* Grid de formulario (dos columnas en md+) */
#modal-tarea .form-grid{
  display: grid;
  grid-template-columns: 1fr;
  gap: .9rem 1rem;
}
@media (min-width: 640px){
  #modal-tarea .form-grid{
    grid-template-columns: 1fr 1fr;
  }
}
/* Filas full-width dentro del grid */
#modal-tarea .form-grid .full{
  grid-column: 1 / -1;
}

/* Campos y labels */
#modal-tarea .form-row{
  display: flex;
  flex-direction: column;
  gap: .35rem;
}
#modal-tarea label{
  font-size: .92rem;
  font-weight: 600;
  color: #374151;
}

/* Inputs base */
#modal-tarea input[type="text"],
#modal-tarea input[type="number"],
#modal-tarea input[type="date"],
#modal-tarea input[type="datetime-local"],
#modal-tarea select,
#modal-tarea textarea{
  width: 100%;
  appearance: none;
  background: #fff;
  border: 1px solid #e5e7eb;
  border-radius: 10px;
  padding: .6rem .75rem;
  font-size: .95rem;
  line-height: 1.25rem;
  color: #111827;
  outline: none;
  transition: border-color .15s ease, box-shadow .15s ease;
}
#modal-tarea textarea{
  min-height: 96px;
  resize: vertical;
}
#modal-tarea select:disabled{
  color: #9ca3af;
}

/* Focus */
#modal-tarea input:focus,
#modal-tarea select:focus,
#modal-tarea textarea:focus{
  border-color: #93c5fd;          /* azul claro */
  box-shadow: 0 0 0 3px rgba(147,197,253,.35);
}

/* Inputs numéricos: quita spinners (WebKit) */
#modal-tarea input[type="number"]::-webkit-outer-spin-button,
#modal-tarea input[type="number"]::-webkit-inner-spin-button{
  -webkit-appearance: none;
  margin: 0;
}
/* Firefox */
#modal-tarea input[type="number"]{
  -moz-appearance: textfield;
}

/* Pie del modal (acciones) */
#modal-tarea .modal-actions{
  display: flex;
  gap: .75rem;
  justify-content: flex-end;
  margin-top: 1rem;
}

/* Botón primario y secundario coherentes con tu sistema */
#modal-tarea .btn-submit,
#modal-tarea .btn{
  border-radius: 10px;
  padding: .6rem 1rem;
  font-weight: 700;
  cursor: pointer;
}
#modal-tarea .btn-submit{
  background: #1d4ed8;   /* azul */
  color: #fff;
  border: 1px solid #1d4ed8;
}
#modal-tarea .btn{
  background: #f3f4f6;   /* gris claro */
  color: #111827;
  border: 1px solid #e5e7eb;
}
#modal-tarea .btn[disabled],
#modal-tarea .btn-submit[disabled]{
  opacity: .6;
  cursor: not-allowed;
}

/* Select con caret simple (opcional) */
#modal-tarea select{
  background-image:
    linear-gradient(45deg, transparent 50%, #6b7280 50%),
    linear-gradient(135deg, #6b7280 50%, transparent 50%);
  background-position:
    calc(100% - 18px) calc(50% - 4px),
    calc(100% - 12px) calc(50% - 4px);
  background-size: 6px 6px, 6px 6px;
  background-repeat: no-repeat;
  padding-right: 2rem;
}

/* Close button (“×”) consistente */
#modal-tarea .modal-close{
  position: absolute;
  top: .5rem;
  right: .6rem;
  border: none;
  background: transparent;
  font-size: 1.4rem;
  line-height: 1;
  cursor: pointer;
  color: #6b7280;
}
#modal-tarea .modal-close:hover{ color:#111827; }


/* ===== MODALES (robustos por aria-hidden) ===== */
.modal-overlay{
  position: fixed;
  inset: 0;
  display: none;                /* oculto por defecto */
  align-items: center;
  justify-content: center;
  /* OJO: usar background con alpha, NO opacity, para no afectar a los hijos */
  background: rgba(17, 24, 39, 0.55);
  z-index: 20000;               /* por encima de header/avatars/etc. */
}

/* Mostrar cuando aria-hidden=false (tu JS ya lo setea) */
.modal-overlay[aria-hidden="false"]{
  display: flex;
}

/* Tarjeta */
.modal-overlay .modal-content{
  width: min(720px, 92vw);
  max-height: 84vh;
  overflow: auto;
  background: #fff;
  border-radius: 14px;
  box-shadow: 0 20px 60px rgba(0,0,0,.25);
  padding: 24px;
  position: relative;

  /* Animación de entrada */
  opacity: 0;
  transform: translateY(-8px) scale(.985);
  transition: opacity .18s ease, transform .18s ease;
}

/* Cuando el overlay está visible, revelar contenido */
.modal-overlay[aria-hidden="false"] .modal-content{
  opacity: 1;
  transform: translateY(0) scale(1);
}

/* Botón cerrar (X) */
.modal-overlay .modal-close{
  position: absolute;
  top: 10px; right: 12px;
  width: 32px; height: 32px;
  border: 0; background: transparent;
  font-size: 24px; line-height: 1;
  color: #6b7280; cursor: pointer;
}
.modal-overlay .modal-close:hover{ color:#111827; }

.modal-overlay{
  position: fixed; inset: 0; display: none;
  align-items: center; justify-content: center;
  background: rgba(17,24,39,.55); backdrop-filter: blur(2px);
  z-index: 3000; /* por encima de toolbars/headers */
}
.modal-overlay.open,
.modal-overlay[aria-hidden="false"] { display: flex; }

.modal-content{
  position: relative; width: min(720px, 92vw);
  max-height: 86vh; overflow: auto;
  background: #fff; border-radius: 14px;
  box-shadow: 0 10px 30px rgba(0,0,0,.2);
  padding: 20px 22px 18px;
}
.modal-close{
  position: absolute; top: 10px; right: 12px;
  font-size: 22px; line-height: 1; cursor: pointer;
  border: 0; background: transparent; color: #111827;
}










/* === Control de estatus ======================= */
#req-status{
  display:flex; align-items:center; gap:.5rem; flex-wrap:wrap;
}

/* Badge alineado */
#req-status .exp-badge{ line-height:1; }

/* Botón (por data-role) */
#req-status [data-role="status-btn"]{
  display: none;
  appearance:none; border:1px solid #d6d9e0; background:#fff;
  font-size:.875rem; line-height:1; padding:.45rem .65rem; border-radius:.5rem;
  cursor:pointer; transition:background .15s, box-shadow .15s, border-color .15s;
}
#req-status [data-role="status-btn"]:hover{
  background:#f7f8fb; border-color:#c8cdd8; box-shadow:0 1px 0 rgba(20,20,20,.04);
}
#req-status [data-role="status-btn"]:active{ background:#eef1f6; }
#req-status [data-role="status-btn"]:focus-visible{
  outline:2px solid #8aa4ff; outline-offset:2px;
}

/* Select (por data-role) */
#req-status [data-role="status-select"]{
  font-size:.875rem; padding:.45rem .55rem; border:1px solid #d6d9e0; border-radius:.5rem;
  background:#fff; line-height:1.2; max-width:100%;
}
#req-status [data-role="status-select"]:focus{
  outline:none; border-color:#8aa4ff; box-shadow:0 0 0 3px rgba(138,164,255,.25);
}
#req-status [data-role="status-select"][hidden]{ display:none !important; }

/* Responsive */
@media (max-width:720px){
  #req-status{ gap:.4rem; }
  #req-status [data-role="status-select"]{ width:100%; }
}

/* (Opcional) si quieres quitar el inline-style del HTML */
#req-status .status-tools{ display:inline-flex; gap:8px; align-items:center; margin-left:8px; }


#modal-media .media-body img{
  max-height: min(72vh, 900px);
  object-fit: contain;
}


/* ==== override fuerte, sólo para el modal de evidencias ==== */
#modal-media.modal-overlay {
  position: fixed;
  inset: 0;
  /* oculto por defecto */
  display: none !important;
  opacity: 0 !important;
  visibility: hidden !important;

  align-items: center;
  justify-content: center;
  padding: 1.25rem;

  /* backdrop */
  background: rgba(17, 24, 39, .60) !important;
  -webkit-backdrop-filter: blur(2px);
  backdrop-filter: blur(2px);

  /* por encima de todo lo demás */
  z-index: 9000 !important; 
  transition: opacity .18s ease, visibility .18s ease;
}

#modal-media.modal-overlay[aria-hidden="false"],
#modal-media.modal-overlay.open {
  display: flex !important;
  opacity: 1 !important;
  visibility: visible !important;
  pointer-events: auto !important;
}

#modal-media .modal-content {
  position: relative;
  max-width: min(92vw, 980px);
  max-height: 90vh;
  overflow: auto;
  background: #fff !important;    
  border-radius: 12px;
  padding: 16px 16px 20px;
  box-shadow: 0 12px 48px rgba(0,0,0,.28);
}

#modal-media .modal-close {
  position: absolute;
  top: 8px;
  right: 10px;
  border: 0;
  background: transparent;
  font-size: 28px;
  line-height: 1;
  cursor: pointer;
}

#modal-media img#media-img {
  max-width: 100%;
  height: auto;
  display: block;
  margin: 0 auto;
  border-radius: 8px;
}

body.me-modal-open { overflow: hidden; }


/* ====== Modal PERFIL  ====== */
#modal-perfil.modal-overlay {
  position: fixed;
  inset: 0;

  /* oculto por defecto */
  display: none !important;
  opacity: 0 !important;
  visibility: hidden !important;

  /* layout */
  align-items: center;
  justify-content: center;
  padding: 1.25rem;

  /* backdrop */
  background: rgba(17, 24, 39, .60) !important;
  -webkit-backdrop-filter: blur(2px);
  backdrop-filter: blur(2px);

  /* por encima de todo lo demás */
  z-index: 2147483646 !important;

  transition: opacity .18s ease, visibility .18s ease;
}

#modal-perfil.modal-overlay.active,
#modal-perfil.modal-overlay[aria-hidden="false"] {
  display: flex !important;
  opacity: 1 !important;
  visibility: visible !important;
  pointer-events: auto !important;
}

/* caja del diálogo */
#modal-perfil .modal-content {
  position: relative;
  width: 100%;
  max-width: min(92vw, 880px);
  max-height: 90vh;
  overflow: auto;

  background: #fff !important;      
  border-radius: 12px;
  padding: 16px 16px 20px;
  box-shadow: 0 12px 48px rgba(0,0,0,.28);
}

/* botón cerrar */
#modal-perfil .modal-close {
  position: absolute;
  top: 8px;
  right: 10px;
  border: 0;
  background: transparent;
  font-size: 28px;
  line-height: 1;
  cursor: pointer;
}

body.modal-open { overflow: hidden; }


/* Celda "Nombre" con mini preview */
.exp-table .file {
  display: inline-flex;
  align-items: center;
  gap: 10px;
  min-width: 0;            /* para que el nombre pueda truncarse */
}

.exp-table .file .ico {
  width: 28px;
  height: 28px;
  flex: 0 0 28px;
  border-radius: 6px;
  object-fit: contain;     /* íconos genéricos */
  background: #f3f4f6;
}

.exp-table .file .ico.is-thumb {
  object-fit: cover;       /* recorta miniatura real */
  box-shadow: 0 0 0 1px rgba(0,0,0,.06) inset;
}

.exp-table .file span {
  display: inline-block;
  max-width: clamp(180px, 32vw, 520px);
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}
